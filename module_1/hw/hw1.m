fprintf("\n")
fprintf("\n")
disp("hw1")
disp("-----------")

%u = [1 -2 0 0; 0 1 -1 0; 0 0 1 -3; 0 0 0 1];
%c = [-4; -5; 2; 4];

%A = [2 2 1 17; 0 1 3 1; 1 0 -6 11];
%A(3,:) = A(3,:) - 1/2 * A(1,:);
%A(3,:) = A(3,:) + A(2,:);

%u = A(:, [1,2,3]);
%c = A(:, 4);

%A = [8 9 10; 3 5 7];
%A(1,:) = 3*A(1,:);
%A(2,:) = 8*A(2,:);
%A(2,:) = A(2,:) - A(1,:);
%u = A(:, [1,2]);
%c = A(:, 3);

%A = [1 5 8; 2 10 17];
%A(2,:) = A(2,:) - 2*A(1,:)

%A = [1 4 1 -1; 3 1 -4 -2; 1 7 2 -4];
%A(2,:) = A(2,:) - 3*A(1,:);
%A(3,:) = A(3,:) - A(1,:);
%A(2,:) = 3*A(2,:);
%A(3,:) = 11*A(3,:);
%A(3,:) = A(3,:) + A(2,:)
%u = A(:, [1,2,3]);
%c = A(:,4);

%A = [2 0 6 0 10; 0 1 0 -2 2; 0 -2 6 1 3; 6 0 0 6 -3];
%A(3,:) = A(3,:)  + 2*A(2,:);
%A(4,:) = A(4,:) - 3*A(1,:);
%A(4,:) = A(4,:) + 3*A(3,:);

A = [1 1 1 100; -8 -1 7 0; 1 -1 1 0];
[L, Z] = lu(A)

A(2,:) = A(2,:) + 8*A(1,:);
A(3,:) = A(3,:) - A(1,:);
A(3,:) = 7*A(3,:);
A(2,:) = 2*A(2,:);
A(3,:) = A(3,:) +  A(2,:);

u = A(:,[1,2,3]);
c = A(:,4);

BackwardSub(u,c)'

u = Z(:,[1,2,3]);
c = Z(:,4);

BackwardSub(u,c)'

function y = BackwardSub(a,b)
	n = length(b);
	y(n,1) = b(n)/a(n,n);
	for i = n-1:-1:1
		y(i,1) = (b(i)-a(i,i+1:n)*y(i+1:n,1))./a(i,i);
	end
end
